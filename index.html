<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>French Words with Pronunciation</title>
    <!-- Add Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Add Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
      :root {
        --primary: #4f46e5;
        --primary-dark: #4338ca;
        --text: #1f2937;
        --text-light: #6b7280;
        --bg: #f9fafb;
        --card-bg: #ffffff;
        --border: #e5e7eb;
      }
      
      body {
        font-family: 'Inter', Arial, sans-serif;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: row;
        min-height: 100vh;
        background-color: var(--bg);
        color: var(--text);
        line-height: 1.5;
      }

      #word-table td,
      #word-link a {
        text-decoration: none;
      }

      .container {
        display: flex;
        width: 100%;
        gap: 1.5rem;
        padding: 1.5rem;
        box-sizing: border-box;
      }

      .table-container {
        flex: 1;
        padding: 1.5rem;
        overflow-y: auto;
        max-height: 100vh;
        background-color: var(--card-bg);
        border-radius: 0.75rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }

      .widget-container {
        flex: 1;
        padding: 1.5rem;
        background-color: var(--card-bg);
        border-left: 1px solid var(--border);
        position: sticky;
        top: 0;
        height: 100vh;
        border-radius: 0.75rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
      }

      h2 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-top: 0;
        margin-bottom: 1rem;
        color: var(--text);
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th,
      td {
        text-align: left;
        padding: 0.75rem 1rem;
        border-bottom: 1px solid var(--border);
      }

      th {
        background-color: var(--bg);
        font-weight: 500;
        color: var(--text-light);
        text-transform: uppercase;
        font-size: 0.75rem;
        letter-spacing: 0.05em;
      }

      tr:hover {
        background-color: rgba(79, 70, 229, 0.03);
      }

      td.clickable-word {
        color: var(--primary);
        cursor: pointer;
        font-weight: 500;
        transition: all 0.15s ease;
      }

      td.clickable-word:hover {
        color: var(--primary-dark);
      }

      #word-link a {
        color: var(--primary);
        display: none;
        font-size: 0.875rem;
        padding: 0.5rem 0;
        transition: color 0.15s ease;
      }

      #word-link a:hover {
        color: var(--primary-dark);
      }

      #youglish-widget {
        width: 100%;
        min-height: 300px;
        align-items: center;
        justify-content: center;
        background-color: var(--bg);
        border-radius: 0.5rem;
        margin-bottom: 1rem;
        overflow: hidden;
      }

      /* CSV Input Area Styles */
      .csv-input-container {
        margin-top: 1rem;
        border-top: 1px solid var(--border);
        padding-top: 1rem;
      }

      .csv-toggle {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--primary);
        cursor: pointer;
        font-size: 0.875rem;
        margin-bottom: 0.5rem;
      }

      .csv-toggle:hover {
        color: var(--primary-dark);
      }

      .csv-input-area {
        display: none;
        width: 100%;
        margin-bottom: 0.5rem;
      }

      .csv-input-area textarea {
        width: 100%;
        min-height: 100px;
        padding: 0.75rem;
        border: 1px solid var(--border);
        border-radius: 0.375rem;
        font-family: monospace;
        font-size: 0.875rem;
        resize: vertical;
      }

      .csv-input-area.active {
        display: block;
      }

      .csv-buttons {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.5rem;
      }

      button {
        padding: 0.5rem 1rem;
        border-radius: 0.375rem;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.15s ease;
      }

      .btn-primary {
        background-color: var(--primary);
        color: white;
        border: none;
      }

      .btn-primary:hover {
        background-color: var(--primary-dark);
      }

      .btn-secondary {
        background-color: var(--bg);
        color: var(--text);
        border: 1px solid var(--border);
      }

      .btn-secondary:hover {
        background-color: #f3f4f6;
      }

      @media (max-width: 768px) {
        .container {
          flex-direction: column;
          padding: 1rem;
        }

        .table-container,
        .widget-container {
          max-height: none;
          height: auto;
        }

        .widget-container {
          border-left: none;
          border-top: 1px solid var(--border);
          position: static;
        }

        #youglish-widget {
          min-height: 250px;
          aspect-ratio: 16/9;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Table Container -->
      <div class="table-container">
        <h2><i class="fas fa-list-ul"></i>French Words</h2>
        <table id="word-table">
          <thead>
            <tr>
              <th>Number</th>
              <th>French</th>
              <th>In English</th>
            </tr>
          </thead>
          <tbody>
            <!-- Rows will be dynamically generated -->
          </tbody>
        </table>
      </div>

      <!-- Widget Container -->
      <div class="widget-container">
        <h2><i class="fas fa-volume-up"></i>Pronunciation</h2>
        <!-- Add link container -->
        <div id="word-link" class="mb-4">
          <a href="" target="_blank"></a>
        </div>
        <div id="youglish-widget">
          <p style="color: var(--text-light);">Select a word to hear pronunciation</p>
        </div>

        <!-- CSV Input Area -->
        <div class="csv-input-container">
          <div class="csv-toggle" id="csv-toggle">
            <i class="fas fa-plus-circle"></i>
            <span>Add new words (CSV format)</span>
          </div>
          <div class="csv-input-area" id="csv-input-area">
            <textarea id="csv-input" placeholder="Enter words in CSV format (French,English)&#10;Example:&#10;lundi,monday&#10;mardi,tuesday&#10;mercredi,wednesday"></textarea>
            <div class="csv-buttons">
              <button class="btn-primary" id="add-words-btn">Add Words</button>
              <button class="btn-secondary" id="clear-words-btn">Clear All</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- YouGlish initialization -->
    <script src="https://youglish.com/public/emb/widget.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // Initialize the YouGlish widget
        let youglishWidget = null;

        // Load words from localStorage or use default words
        let words = loadWordsFromStorage();

        // DOM elements
        const tableBody = document.querySelector("#word-table tbody");
        const csvToggle = document.getElementById("csv-toggle");
        const csvInputArea = document.getElementById("csv-input-area");
        const csvInput = document.getElementById("csv-input");
        const addWordsBtn = document.getElementById("add-words-btn");
        const clearWordsBtn = document.getElementById("clear-words-btn");
        const widgetContainer = document.getElementById("youglish-widget");

        // Toggle CSV input area
        csvToggle.addEventListener("click", () => {
          csvInputArea.classList.toggle("active");
          const icon = csvToggle.querySelector("i");
          if (csvInputArea.classList.contains("active")) {
            icon.classList.replace("fa-plus-circle", "fa-minus-circle");
          } else {
            icon.classList.replace("fa-minus-circle", "fa-plus-circle");
          }
        });

        // Add words from CSV
        addWordsBtn.addEventListener("click", () => {
          const csvText = csvInput.value.trim();
          if (csvText) {
            const newWords = parseCSV(csvText);
            if (newWords.length > 0) {
              words = [...words, ...newWords];
              saveWordsToStorage(words);
              renderTable();
              csvInput.value = "";
              alert(`${newWords.length} words added successfully!`);
            } else {
              alert("No valid words found in the CSV input.");
            }
          }
        });

        // Clear all words
        clearWordsBtn.addEventListener("click", () => {
          if (confirm("Are you sure you want to clear all words?")) {
            words = [];
            saveWordsToStorage(words);
            renderTable();
          }
        });

        // Render the table with words
        function renderTable() {
          tableBody.innerHTML = "";
          words.forEach((word, index) => {
            const row = document.createElement("tr");

            const numberCell = document.createElement("td");
            numberCell.textContent = index + 1;
            row.appendChild(numberCell);

            const frenchCell = document.createElement("td");
            frenchCell.classList.add("clickable-word");
            frenchCell.textContent = word.french;
            frenchCell.addEventListener("click", () =>
              loadYouGlishWidget(word.french)
            );
            row.appendChild(frenchCell);

            const englishCell = document.createElement("td");
            englishCell.textContent = word.english;
            row.appendChild(englishCell);

            tableBody.appendChild(row);
          });
        }

        // Load YouGlish widget for a word
        function loadYouGlishWidget(word) {
          const wordLink = document.querySelector("#word-link a");

          const youglishUrl = `https://youglish.com/pronounce/${word}/french/fr`;
          wordLink.href = youglishUrl;
          wordLink.textContent = youglishUrl;
          wordLink.style.display = "block";

          // Clear previous widget
          widgetContainer.innerHTML = "";
          
          // Create a new container for the widget
          const widgetDiv = document.createElement('div');
          widgetDiv.id = 'yg-widget-' + Date.now();
          widgetContainer.appendChild(widgetDiv);

          // Initialize the widget
          youglishWidget = new YG.Widget(widgetDiv, {});

          youglishWidget.fetch(word, "french");
        }

        // Parse CSV text into word objects
        function parseCSV(csvText) {
          return csvText.split('\n')
            .map(line => line.trim())
            .filter(line => line.length > 0)
            .map(line => {
              const [french, english] = line.split(',').map(part => part.trim());
              return { french, english };
            })
            .filter(word => word.french && word.english);
        }

        // Load words from localStorage
        function loadWordsFromStorage() {
          const storedWords = localStorage.getItem('frenchWords');
          if (storedWords) {
            return JSON.parse(storedWords);
          }
          // Default words if nothing in storage
          return [
            { french: "comme", english: "as" },
            { french: "je", english: "I" },
            { french: "son", english: "his" },
            { french: "que", english: "that" },
            { french: "il", english: "he" },
            { french: "était", english: "was" },
            { french: "pour", english: "for" },
          ];
        }

        // Save words to localStorage
        function saveWordsToStorage(words) {
          localStorage.setItem('frenchWords', JSON.stringify(words));
        }

        // Initial render
        renderTable();
        
        // Load first word by default if exists
        if (words.length > 0) {
          loadYouGlishWidget(words[0].french);
        }
      });
    </script>
  </body>
</html>
